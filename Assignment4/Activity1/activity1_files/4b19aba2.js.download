var SaveAction;(function(n){function st(){}function li(n,r){var a;if(u&&!Lib.CssClass.contains(u,t)&&Lib.CssClass.add(u,t),l&&sb_ct(l),a=n.parentElement,a&&i&&Lib.CssClass.contains(a,ur)){a.contains(i)||a.appendChild(i);rt&&y(ri,h,rt);rt=sj_wf(ct,n);f(ri,h,rt);i.style.transform="";var p=i.getBoundingClientRect().right,w=_w.innerWidth,v=p-w+8;v>0&&(i.style.transform="translateX(calc(-50% - "+v+"px))");Lib.CssClass.remove(i,gt);l=sb_st(c,r);f(_d,h,c);e(k,o,"",!1,s,ut)}}function br(){u&&!Lib.CssClass.contains(u,t)&&Lib.CssClass.add(u,t);p&&(ki(),Lib.CssClass.remove(p,t),e(k,o,"",!1,s,ut),si=ai([fr],function(){di();p&&Lib.CssClass.add(p,t)}))}function kr(){u&&!Lib.CssClass.contains(u,t)&&Lib.CssClass.add(u,t);v&&w&&(ki(),Lib.CssClass.remove(w,oi),Lib.CssClass.add(w,ei),Lib.CssClass.remove(v,t),f(fi,h,c),e(k,o,"",!1,s,ut),hi=ai([ui],function(){di();v&&w&&(Lib.CssClass.remove(w,ei),Lib.CssClass.add(w,oi),sb_st(function(){Lib.CssClass.add(v,t)},er))}))}function dr(){u&&!Lib.CssClass.contains(u,t)&&Lib.CssClass.add(u,t);g&&sb_ct(g);b&&(Lib.CssClass.remove(b,t),g=sb_st(c,or),e(k,o,"",!1,s,ut))}function ai(n,t,i){function r(t){var i=sj_et(t),r=n.some(function(n){return sj_fa(i,n)!=null}),f=t.key==="Escape";(!r||f)&&u(t)}function u(n){t(n);i&&(y(_d,h,r),y(_d,bt,r),y(_d,kt,r))}if(i===void 0&&(i=!0),n!=null&&n.length!==0)return sb_st(function(){f(_d,h,r);f(_d,bt,r);f(_d,kt,r)},0),u}function c(){a.shouldShowModalOnSave?si():a.shouldShowBottomSheetOrDrawerOnSave?Lib.CssClass.contains(v,t)?(sb_ct(g),g=null,b&&Lib.CssClass.add(b,t)):(y(fi,h,c),hi()):(sb_ct(l),l=null,y(_d,h,c),i&&Lib.CssClass.add(i,gt))}function gr(n,t){a.shouldShowModalOnSave?br():a.shouldShowBottomSheetOrDrawerOnSave&&et!==null?et.savCtrlHusbs!=="true"?(kr(),et.savCtrlHusbs="true"):dr():r(n,at)===dt&&li(n,t===!0||a.disableActionPopupAutoDismiss?ii:ot)}function vi(n){l&&sb_ct(l);l=sb_st(c,n)}function yi(n){var t="https://"+location.host+"/images/favorites/manage?action="+n;return typeof sj_cook!="undefined"&&(t+="&sid="+(_G.SID||sj_cook.get("_SS","SID"))),t}function pi(n){return _d.querySelectorAll("["+nt+"='"+n+"']")}function nu(n,t){var u;t===void 0&&(t=!0);var e=r(n,nt),f=pi(e),o=r(n,tt)===it,i=null;for(u=0;u<f.length;u++)if(i=r(f[u],yt),i&&i.length>0){try{i=JSON.parse(i)}catch(s){continue}t&&(o?(i.specifier={id:null,collectionType:null},i=[i]):i.specifier={collectionType:parseInt(r(f[u],nr),10)});i=encodeURIComponent(JSON.stringify(i));break}return i}function tu(n){n&&r(n,tt)===it&&(a.shouldShowModalOnSave||a.shouldShowBottomSheetOrDrawerOnSave||li(n,ot))}function wi(n,t){for(var i,f=pi(n),u=0;u<f.length;u++)if(i=f[u],i){var e=i.querySelector(tr),o=i.querySelector(ir),s=t?locStrings.remove:locStrings.save;e&&(e.innerHTML=t?SaveSvgIcon.savedIcon:SaveSvgIcon.saveIcon);o&&(o.innerHTML=s);r(i,pt)&&lt(i,pt,s);lt(i,tt,t?it:"0")}}function ct(n,t){var l=r(n,nt),i=r(n,tt)===it,u=i?cr:hr,h,f;(e(ar,o,"",!1,s,u),h=yi(i?d.DeleteItems:d.AddItems),f=nu(n),f)&&AjaxRequestProcessor.SendRequest(h,f,null,null,function(r){var f=null,h;if(r&&r.length)try{f=JSON.parse(r)}catch(a){return}h=i;f&&f.IsSuccess?(wi(l,!i),i?c():gr(n,t),sj_evt&&sj_evt.fire(h?pr:vr,n),e(k,o,"",!1,s,u)):(sj_evt&&sj_evt.fire(h?wr:yr,n),e(ht,o,"",!1,s,u))})}function iu(n,t){var f,l,h,a,c,v,i,u;if(!t||(f=r(t,yt),l=r(t,nt),!f||f.length===0||!l))return null;a={};try{for(i=JSON.parse(f),u=0;u<ti.length;u++)if(c=ti[u],i.hasOwnProperty(c[0])){h=c[0];v=c[1];a[v]=i[h][0][v];break}}catch(y){e(ht,o,"",!1,s,lr,sr,JSON.stringify(f))}if(h){for(i=null,u=0;u<n.length;u++)if(n[u].type===h){i=n[u];break}i||(i={type:h,saveIds:[],itemsMeta:[]},n.push(i));i.saveIds.push(l);i.itemsMeta.push(a)}}function ru(n){if(n&&n.length){var t=yi(d.GetStatus);n.forEach(function(n){if(n.itemsMeta.length>0){var i={};i[n.type]=n.itemsMeta;AjaxRequestProcessor.SendRequest(t,encodeURIComponent(JSON.stringify(i)),null,null,function(t){var i=null,u,r,f;if(t&&t.length)try{i=JSON.parse(t)}catch(h){return}if(i&&i.IsSuccess&&i.Result&&i.Result.length>0){for(u=n.saveIds,r=0;r<u.length;r++)(f=i.Result[r].Present,f)&&wi(u[r],!0);e(k,o,"",!1,s,ci)}else e(ht,o,"",!1,s,ci)})}})}}function bi(){var u=_d.querySelectorAll(gi),e=[],t,n,o;if(u){for(t=0;t<u.length;t++)if(n=u[t],n){if(r(n,vt)==="1")continue;lt(n,vt,"1");o=sj_wf(ct,n);f(n,h,o);typeof AccessibilityHelpers!="undefined"&&AccessibilityHelpers.activateButtonByKey(n,[13,32],sj_wf(ct,n,!0));i&&r(n,at)===dt&&f(n,wt,sj_wf(tu,n));shouldUseAjaxToGetStatus==="true"&&iu(e,n)}ru(e)}i?(f(i,wt,sj_wf(vi,ii),!0),f(i,rr,sj_wf(vi,ot),!0)):p?_d.body.appendChild(p):v&&b&&(_d.body.appendChild(v),_d.body.appendChild(b))}function r(n,t){return n?n.getAttribute(t):null}function lt(n,t,i){n&&n.setAttribute(t,i)}function ki(){n.reversiblySetCssProperty(document.body,ni,-n.getBodyScrollTop()+"px");Lib.CssClass.add(document.body,"body_stop-page-scrolling")}function di(){var t=document.body.style.top;n.revertCssProperty(document.body,ni);Lib.CssClass.remove(document.body,"body_stop-page-scrolling");t!=null&&t!==""&&n.setBodyScrollTop(-parseInt(t,10))}function uu(){try{return _w.localStorage}catch(n){return null}}function fu(n,t,i){var r=n.style[t];r!=null&&r!==""&&n.setAttribute(ft+t,r);n.style[t]=i}function eu(n,t){var i=n.getAttribute(ft+t);n.style[t]=i!=null&&i!==""?i:null;n.removeAttribute(ft+t)}function ou(){return window.pageYOffset||document.documentElement!=null&&document.documentElement.scrollTop||document.body.scrollTop||0}function su(n){document.documentElement!=null&&(document.documentElement.scrollTop=n);document.body.scrollTop=n}var d,ft;(function(n){n.AddItems="addItems";n.DeleteItems="deleteItems";n.GetStatus="getStatus"})(d||(d={}));var gi="[data-type='saveAction']",nt="data-saveId",tt="data-isSaved",at="data-promoted",vt="data-initialized",nr="data-colltype",yt="data-itemmeta",tr=".actIconSvg",ir=".actionlabel,.actLabel",pt="title",t="b_hide",rr="mouseout",wt="mouseenter",h="click",bt="focusin",kt="keydown",ur="sav-ctrl",dt="1",it="1",gt="sav-ctrl-vis-hide",ni="top",f=sj_be,y=sj_ue,et=uu(),a=_w.saveActionConfigs||{shouldShowModalOnSave:!1,shouldShowBottomSheetOrDrawerOnSave:!1,disableActionPopupAutoDismiss:!1},ti=[["webresults","purl"],["entities","entityId"],["videos","mid"],["images","cid"]],l,ii=99999,ot=3e3,i=_ge("sav-ctrl-flyout"),ri=i?i.querySelector(".sav-ctrl__flyout-remove"):null,rt=null,u=_ge("crtAct_tlTp"),fr=".sav-ctrl-modal__window",p=_qs(".sav-ctrl-modal__wrapper"),ui=".sav-ctrl-bottom-sheet__window",w=_qs(ui),v=_qs(".sav-ctrl-bottom-sheet__wrapper"),er=350,fi=_qs(".sav-ctrl-bottom-sheet__dismiss-button"),ei="sav-ctrl-bottom-sheet__animate-in",oi="sav-ctrl-bottom-sheet__animate-out",g,or=2800,b=_qs(".sav-ctrl-drawer"),si=st,hi=st;var e=Log&&Log.Log?Log.Log:st,o="SaveCtrl",s="Meta",sr="Value",hr="Save",cr="Remove",ci="GetStatus",lr="GetStatusItemMeta",ut="ShowFlyout",ar="Click",k="Success",ht="Failure",vr="Save_Success",yr="Save_Fail",pr="Remove_Success",wr="Remove_Fail";n.hideSaveConfirmation=c;f(_w,"load",bi);sj_evt&&sj_evt.bind("ajax.load",bi);ft="data-old-style-";n.reversiblySetCssProperty=fu;n.revertCssProperty=eu;n.getBodyScrollTop=ou;n.setBodyScrollTop=su})(SaveAction||(SaveAction={}))